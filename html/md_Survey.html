<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: From LLVM Bitcode to Boogie IVL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">From LLVM Bitcode to Boogie IVL </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">if (!Modular) {</div>
<div class="line">    auto PreserveKeyGlobals = [=](const llvm::GlobalValue &amp;GV) {</div>
<div class="line">      std::string name = GV.getName();</div>
<div class="line">      return smack::SmackOptions::isEntryPoint(name) ||</div>
<div class="line">             smack::Naming::isSmackName(name) ||</div>
<div class="line">             name.find(&quot;__VERIFIER_assume&quot;) != std::string::npos;</div>
<div class="line">    };</div>
<div class="line">    //createInternalizePass - This pass loops over all of the functions in the input module, internalizing all globals (functions and variables) it can.</div>
<div class="line"> </div>
<div class="line">    ------------------------------------------------------------</div>
<div class="line">    1 ----------------------------------------------------------</div>
<div class="line">    //Before internalizing a symbol, the callback MustPreserveGV is invoked and gives to the client the ability to prevent internalizing specific symbols.</div>
<div class="line">    pass_manager.add(llvm::createInternalizePass(PreserveKeyGlobals));</div>
<div class="line">    2 ----------------------------------------------------------</div>
<div class="line">    //eliminate unreachable internal globals from the program</div>
<div class="line">    pass_manager.add(llvm::createGlobalDCEPass());</div>
<div class="line">    // Dead Inst Elimination performs a single pass over the function removing</div>
<div class="line">    // instructions that are obviously dead</div>
<div class="line">    pass_manager.add(llvm::createDeadCodeEliminationPass());</div>
<div class="line"> </div>
<div class="line">    pass_manager.add(llvm::createGlobalDCEPass());</div>
<div class="line">    pass_manager.add(llvm::createDeadCodeEliminationPass());</div>
<div class="line">    3 ----------------------------------------------------------</div>
<div class="line">    // remove the dead function definitions except those who with special prefix as __SMACK_ : dead no calls or isTriviallyDead</div>
<div class="line">    pass_manager.add(new smack::RemoveDeadDefs());</div>
<div class="line">    ------------------------------------------------------------</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ------------------------------------------------------------</div>
<div class="line">  4 ----------------------------------------------------------</div>
<div class="line">  // Sea-DSA: context-, field-, and array-sensitive unification-based points-to analysis for LLVM bitcode inspired by DSA</div>
<div class="line">   /*</div>
<div class="line">  *</div>
<div class="line">  clang-format off</div>
<div class="line"> </div>
<div class="line">  Rewrites</div>
<div class="line">   %_311 = bitcast i8** @msg_buf to i32*</div>
<div class="line">   %_312 = load i32, i32* %_311, align 4</div>
<div class="line">   %_313 = bitcast %struct.iovec* %_9 to i32*</div>
<div class="line">   store i32 %_312, i32* %_313, align 4</div>
<div class="line"> </div>
<div class="line">   into</div>
<div class="line"> </div>
<div class="line">   %_311.ptr = bitcast i8** @msg_buf to i8**</div>
<div class="line">   %_312.ptr = load i8*, i8** @_311.ptr, align 4</div>
<div class="line">   %_313.ptr = bitcast %struct.iovec* %_9 to i8**</div>
<div class="line">   store i8* %_312.ptr, i8** %_313.ptr, align 4</div>
<div class="line"> </div>
<div class="line">   clang-format on</div>
<div class="line">  */</div>
<div class="line">  pass_manager.add(seadsa::createRemovePtrToIntPass());</div>
<div class="line">  5 ----------------------------------------------------------</div>
<div class="line"> </div>
<div class="line">  // The LowerSwitch transformation rewrites switch instructions with a sequence of branches, which allows targets to get away with not implementing the switch instruction until it is convenient.</div>
<div class="line">  pass_manager.add(llvm::createLowerSwitchPass());</div>
<div class="line"> </div>
<div class="line">  6 ----------------------------------------------------------</div>
<div class="line"> </div>
<div class="line">  //This file promotes memory references to be register references. It promotes alloca instructions which only have loads and stores as uses. An alloca is transformed by using dominator frontiers to place phi nodes, then traversing the function in depth-first order to rewrite loads and stores as appropriate.</div>
<div class="line">  pass_manager.add(llvm::createPromoteMemoryToRegisterPass());</div>
<div class="line">  </div>
<div class="line">  7 ----------------------------------------------------------</div>
<div class="line">  // Unroll the loop</div>
<div class="line">  if (StaticUnroll) {</div>
<div class="line">    pass_manager.add(llvm::createLoopSimplifyPass());</div>
<div class="line">    pass_manager.add(llvm::createLoopRotatePass());</div>
<div class="line">    // pass_manager.add(llvm::createIndVarSimplifyPass());</div>
<div class="line">    pass_manager.add(llvm::createLoopUnrollPass(32767));</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  8 ----------------------------------------------------------</div>
<div class="line">  // pass_manager.add(new llvm::StructRet());</div>
<div class="line">  // This pass normalizes loop structures to allow easier generation of Boogie code when a loop edge comes from a branch. Specifically, a forwarding block is added between a branching block and the loop header.</div>
<div class="line">  pass_manager.add(new smack::NormalizeLoops());</div>
<div class="line">  9 ----------------------------------------------------------</div>
<div class="line">  // EV IV on loops</div>
<div class="line">  pass_manager.add(new llvm::SimplifyEV());</div>
<div class="line">  pass_manager.add(new llvm::SimplifyIV());</div>
<div class="line">  10----------------------------------------------------------</div>
<div class="line">  pass_manager.add(new smack::ExtractContracts());</div>
<div class="line">  pass_manager.add(new smack::VerifierCodeMetadata());</div>
<div class="line">  pass_manager.add(llvm::createDeadCodeEliminationPass());</div>
<div class="line">  pass_manager.add(smack::createCodifyStaticInitsPass());</div>
<div class="line">  if (!Modular) {</div>
<div class="line">    pass_manager.add(new smack::RemoveDeadDefs());</div>
<div class="line">  }</div>
<div class="line">  pass_manager.add(new llvm::MergeArrayGEP());</div>
<div class="line">  // pass_manager.add(new smack::SimplifyLibCalls());</div>
<div class="line">  pass_manager.add(new llvm::Devirtualize());</div>
<div class="line">  pass_manager.add(new smack::SplitAggregateValue());</div>
<div class="line"> </div>
<div class="line">  11----------------------------------------------------------</div>
<div class="line">  //Checker passes</div>
<div class="line">  if (smack::SmackOptions::MemorySafety) {</div>
<div class="line">    pass_manager.add(new smack::MemorySafetyChecker());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  pass_manager.add(new smack::IntegerOverflowChecker());</div>
<div class="line"> </div>
<div class="line">  if (smack::SmackOptions::RewriteBitwiseOps &amp;&amp;</div>
<div class="line">      !(smack::SmackOptions::BitPrecise ||</div>
<div class="line">        smack::SmackOptions::BitPrecisePointers)) {</div>
<div class="line">    pass_manager.add(new smack::RewriteBitwiseOps());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  if (smack::SmackOptions::AddTiming) {</div>
<div class="line">    Triple ModuleTriple(module-&gt;getTargetTriple());</div>
<div class="line">    assert(</div>
<div class="line">        ModuleTriple.getArch() &amp;&amp;</div>
<div class="line">        &quot;Module has no defined architecture: unable to add timing annotations&quot;);</div>
<div class="line"> </div>
<div class="line">    const TargetOptions Options;  /* = InitTargetOptionsFromCodeGenFlags();*/</div>
<div class="line">    std::string CPUStr = &quot;&quot;;      /*getCPUStr();*/</div>
<div class="line">    std::string FeaturesStr = &quot;&quot;; /*getFeaturesStr();*/</div>
<div class="line">    TargetMachine *Machine =</div>
<div class="line">        GetTargetMachine(ModuleTriple, CPUStr, FeaturesStr, Options);</div>
<div class="line"> </div>
<div class="line">    assert(Machine &amp;&amp;</div>
<div class="line">           &quot;Module did not have a Target Machine: Cannot set up timing pass&quot;);</div>
<div class="line">    // Add an appropriate TargetLibraryInfo pass for the module&#39;s triple.</div>
<div class="line">    TargetLibraryInfoImpl TLII(ModuleTriple);</div>
<div class="line">    pass_manager.add(new TargetLibraryInfoWrapperPass(TLII));</div>
<div class="line"> </div>
<div class="line">    // Add internal analysis passes from the target machine.</div>
<div class="line">    pass_manager.add(</div>
<div class="line">        createTargetTransformInfoWrapperPass(Machine-&gt;getTargetIRAnalysis()));</div>
<div class="line">    pass_manager.add(new smack::AddTiming());</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md62"></a>
Important Passes</h1>
<ul>
<li>SmackModuleGenerator</li>
<li>MemorySafetyChecker</li>
<li>IntegerOverflowChecker</li>
<li>BplFilePrinter</li>
</ul>
<h1><a class="anchor" id="autotoc_md63"></a>
Important Classes</h1>
<ul>
<li>SmackRep</li>
<li>BoogieAST </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
