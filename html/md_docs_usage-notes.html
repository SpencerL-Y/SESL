<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: usage-notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">usage-notes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document shows several usage scenarios of SMACK that require special flags.</p>
<h2><a class="anchor" id="autotoc_md43"></a>
Loops and Recusive Functions</h2>
<p>First of all, please keep in mind that SMACK is a <em>bounded</em> verifier, which means that in the presense of loops and recursive functions, the verification process unrolls them up to the bound <code>N</code> specified by the flag <code>--unroll &lt;N&gt;</code>. Conceptually, unrolling a loop means transforming a loop into a sequence (length <code>N</code>) of if-else statements, the inner most of which halts the program. Recursive functions are handled by inlining the function <code>N</code> times and the inner most recursive call halts the program. Therefore, not unrolling a loop or a recursive function to a sufficient bound can lead to missed bugs. In other words, when SMACK reports that there are no bugs in a program, it actually means that the program is safe within the bound specified by the user.</p>
<h3><a class="anchor" id="autotoc_md44"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="smack_8h.html">smack.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="build_2CMakeFiles_23_816_83_2CompilerIdC_2CMakeCCompilerId_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordtype">long</span> <a class="code" href="loop_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> = <a class="code" href="smack_8c.html#afdcc836c0043b83bdf4f5fa3005fc649">__VERIFIER_nondet_long</a>();</div>
<div class="line">  <span class="keywordtype">long</span> <a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>, <a class="code" href="pthread_2lock_8c.html#a14f94e529dff0b8bfba8e16fbe9755d6">z</a> = 0;</div>
<div class="line">  <a class="code" href="shadow__mem__2_8c.html#a12ea070ac6c5c0a1eae7fb3e095c7940">assume</a>(<a class="code" href="loop_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> &gt; 2);</div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = 0; <a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> &lt; <a class="code" href="loop_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>; ++ <a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>) <a class="code" href="pthread_2lock_8c.html#a14f94e529dff0b8bfba8e16fbe9755d6">z</a>++;</div>
<div class="line">  <a class="code" href="shadow__mem__2_8c.html#aa2b0b54019654776d2ef1dcdd4076cb9">assert</a>(<a class="code" href="pthread_2lock_8c.html#a14f94e529dff0b8bfba8e16fbe9755d6">z</a> != <a class="code" href="loop_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The assertion in this program should fail. However, if SMACK is invoked with the default unrolling bound <code>1</code>, it reports no errors. This is because the loop has to be unrolled at least 4 times (i.e., after <code>y</code> gets value 3, the minimum value of <code>x</code>, in the 3rd iteration) for the assertion to be reachable.</p>
<h2><a class="anchor" id="autotoc_md45"></a>
Bitwise Operations and Integer Casts</h2>
<p>If the program to verify contains bitwise operations or integer casts, then the flag <code>--integer-encoding=bit-vector</code> may be required. The reason is that SMACK uses the SMT theory of integers to encode machine integers by default, where bitwise operations are encoded using uninterpreted functions returning arbitrary values. Furthermore, precise encoding is required to handle integer signedness casts, which is not also enabled automatically.</p>
<p>The following program demonstrate the problems in the presence of bitwise operations.</p>
<h3><a class="anchor" id="autotoc_md46"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="smack_8h.html">smack.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="build_2CMakeFiles_23_816_83_2CompilerIdC_2CMakeCCompilerId_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordtype">unsigned</span> <a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = <a class="code" href="smack_8c.html#ad6597781ce4e6c82e7553130797005e1">__VERIFIER_nondet_unsigned_int</a>();</div>
<div class="line">  <a class="code" href="shadow__mem__2_8c.html#a12ea070ac6c5c0a1eae7fb3e095c7940">assume</a> (<a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> &lt; 4<a class="code" href="smack_8h.html#a7a5f1ee32c0330618b3e3aa84cc35c94">U</a>);</div>
<div class="line">  <a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> &gt;&gt;= 2<a class="code" href="smack_8h.html#a7a5f1ee32c0330618b3e3aa84cc35c94">U</a>;</div>
<div class="line">  <a class="code" href="shadow__mem__2_8c.html#aa2b0b54019654776d2ef1dcdd4076cb9">assert</a> (!<a class="code" href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>This program should verify. However, if the we run SMACK in its default mode, it reports an assertion violation.</p>
<div class="fragment"><div class="line">$ smack a.c</div>
<div class="line">SMACK program verifier version 1.9.0</div>
<div class="line">/home/shaobo/project/smack/install/share/smack/lib/smack.c(40,1): This assertion can fail</div>
<div class="line">Execution trace:</div>
<div class="line">    ...</div>
<div class="line">    a.c(4,16): Trace: Thread=1  (y = -669)</div>
<div class="line">    ...</div>
<div class="line">    a.c(6,5): Trace: Thread=1  (y = 17)</div>
<div class="line">    ...</div>
<div class="line">SMACK found an error.</div>
</div><!-- fragment --><p>Some steps in the error trace are omitted. As you can see, the concrete values of <code>y</code> in the error trace before and after the bitwise right shift operation do not follow its semantics because it is modeled as an uninterpreted function.</p>
<p>In this case, we need the <code>--integer-encoding=bit-vector</code> flag that, as its name indicates, enables bit-precise modeling of machine integers.</p>
<div class="fragment"><div class="line">$ smack a.c --integer-encoding=bit-vector</div>
<div class="line">SMACK program verifier version 1.9.0</div>
<div class="line">SMACK found no errors with unroll bound 1.</div>
</div><!-- fragment --><p>If the program that you would like to verify contains such patterns, try enabling this flag. However, note that enabling bit-precise reasoning often degrades the performance of SMACK, and causes for it to take much longer to perform the verification.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Floating-Point Arithmetic</h2>
<p>Similar to machine integers, floating-point numbers and arithmetic are modeled using the theory of integers and uninterpreted functions, respectively. Therefore, if the assertions to verify depend on precise modeling of floating-point representations, the flag <code>--float</code> is needed. Note that occasionally <code>--integer-encoding=bit-vector</code> has to be used in addition to <code>--float</code>, in particular when casts between floating-point numbers and integers are present. Moreover, reasoning about floating-point numbers is often very slow. Please let us know if you encounter any performance issues. We can share some experiences that may ease the situation.</p>
<h2><a class="anchor" id="autotoc_md48"></a>
Concurrency</h2>
<p>Reasoning about pthreads is supported by SMACK with the flag <code>--pthread</code>. Please use this flag when you would like to verify a multi-threaded program with pthreads. One important flag for reasoning about concurrent programs is <code>--context-bound</code> which is 1 by default. Try increasing this value if you would like more thorough exploration of the concurrent programs. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="abuild_2CMakeFiles_23_816_83_2CompilerIdC_2CMakeCCompilerId_8c_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="build_2CMakeFiles_23_816_83_2CompilerIdC_2CMakeCCompilerId_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> CMakeCCompilerId.c:645</div></div>
<div class="ttc" id="aloop_8c_html_a6150e0515f7202e2fb518f7206ed97dc"><div class="ttname"><a href="loop_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> loop.c:11</div></div>
<div class="ttc" id="asmack_8h_html_a7a5f1ee32c0330618b3e3aa84cc35c94"><div class="ttname"><a href="smack_8h.html#a7a5f1ee32c0330618b3e3aa84cc35c94">U</a></div><div class="ttdeci">#define U(...)</div><div class="ttdef"><b>Definition:</b> smack.h:88</div></div>
<div class="ttc" id="apthread_2lock_8c_html_a14f94e529dff0b8bfba8e16fbe9755d6"><div class="ttname"><a href="pthread_2lock_8c.html#a14f94e529dff0b8bfba8e16fbe9755d6">z</a></div><div class="ttdeci">int z</div><div class="ttdef"><b>Definition:</b> lock.c:7</div></div>
<div class="ttc" id="asmack_8c_html_afdcc836c0043b83bdf4f5fa3005fc649"><div class="ttname"><a href="smack_8c.html#afdcc836c0043b83bdf4f5fa3005fc649">__VERIFIER_nondet_long</a></div><div class="ttdeci">long __VERIFIER_nondet_long(void)</div><div class="ttdef"><b>Definition:</b> smack.c:1490</div></div>
<div class="ttc" id="asmack_8c_html_ad6597781ce4e6c82e7553130797005e1"><div class="ttname"><a href="smack_8c.html#ad6597781ce4e6c82e7553130797005e1">__VERIFIER_nondet_unsigned_int</a></div><div class="ttdeci">unsigned int __VERIFIER_nondet_unsigned_int(void)</div><div class="ttdef"><b>Definition:</b> smack.c:1481</div></div>
<div class="ttc" id="asmack_8h_html"><div class="ttname"><a href="smack_8h.html">smack.h</a></div></div>
<div class="ttc" id="ashadow__mem__2_8c_html_aa2b0b54019654776d2ef1dcdd4076cb9"><div class="ttname"><a href="shadow__mem__2_8c.html#aa2b0b54019654776d2ef1dcdd4076cb9">assert</a></div><div class="ttdeci">#define assert(X)</div></div>
<div class="ttc" id="ashadow__mem__2_8c_html_a12ea070ac6c5c0a1eae7fb3e095c7940"><div class="ttname"><a href="shadow__mem__2_8c.html#a12ea070ac6c5c0a1eae7fb3e095c7940">assume</a></div><div class="ttdeci">#define assume</div></div>
<div class="ttc" id="alamport__true-unreach-call_8c_html_a0a2f84ed7838f07779ae24c5a9086d33"><div class="ttname"><a href="lamport__true-unreach-call_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> lamport_true-unreach-call.c:11</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
